var bus = require('../systemBus');
var board = require('board');
var observer = require('observer');

function translate(cellString) {
    var map = {
        'A': '1',
        'B': '2',
        'C': '3',
        'D': '4',
        'E': '5',
        'F': '6',
        'G': '7',
        'H': '8'
    };

    cellString = cellString.replace(/^[A-H]/, function(char) { return map[char] });
    return cellString;
}

function gameEngine() {

    bus.on('move', function(data) {
        var movedPiece = board.getPiece(translate(data[0])[0], data[0][1]);
        //console.log(translate(data[0])[0], data[0][1]);
        //var returnVal = observer.move(translate(data[0])[0], data[0][1]);
        bus.emit('moved', movedPiece);
    });
    bus.on('clear', function() {
        // Destroy the game
    });

    this.board = new board();
    return this.board.getPiecemap();
}

module.exports = gameEngine;