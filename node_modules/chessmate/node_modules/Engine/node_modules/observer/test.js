var test = require('./');
var board = require('../board');
var pieceClass = require('../pieces');

// var from = arg

function testPiece() {
        var pieces = new pieceClass();
        this.board = new board(pieces);
        this.observer = new test(this.board, pieces);

        move(pieces, this.board, this.observer, ['A2', 'A4']);
        move(pieces, this.board, this.observer, ['A1', 'A3']);
        move(pieces, this.board, this.observer, ['A3', 'H3']);
        move(pieces, this.board, this.observer, ['H3', 'H7']);
}

function move(pieces, board, observer, data) {
        var square = board.getGridSquare(translate(data[0])[0], data[0][1]);

        console.log(square.getPiece());
        var name = square.getPieceName();

        var returnVal = observer.move(square,
                                      translate(data[1])[0],
                                      data[1][1]);

        console.log('Moving a ' + name + ' from '
                    + data.join(' to ') + ' returns ' + returnVal);
        console.log(board.getPiecemap());
}

function translate(cellString) {
        var map = {
                    'A': '1',
                    'B': '2',
                    'C': '3',
                    'D': '4',
                    'E': '5',
                    'F': '6',
                    'G': '7',
                    'H': '8'
                };

        cellString = cellString.replace(/^[A-H]/, function(char) { return map[char] });
        return cellString;
}

testPiece();