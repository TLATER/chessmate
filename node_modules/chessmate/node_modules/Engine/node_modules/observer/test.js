var test = require('./');
var board = require('../board');
var pieceClass = require('../pieces');

// var from = arg

function testPiece() {
        var pieces = new pieceClass();
        this.board = new board(pieces);
        this.observer = new test(this.board, pieces);

        move(pieces, 1, this.board, this.observer, ['E2', 'E4']);
        move(pieces, 0, this.board, this.observer, ['C7', 'C5']);
        move(pieces, 1, this.board, this.observer, ['F1', 'C4']);
        move(pieces, 0, this.board, this.observer, ['B8', 'C6']);
        move(pieces, 1, this.board, this.observer, ['D1', 'F3']);
        move(pieces, 0, this.board, this.observer, ['A7', 'A6']);
        move(pieces, 1, this.board, this.observer, ['F3', 'F7']);
}


function move(pieces, color, board, observer, data) {
        var square = board.getGridSquare(translate(data[0])[0], data[0][1]);

        var name = square.getPieceName();

        var returnVal = observer.move(square,
                                      color,
                                      translate(data[1])[0],
                                      data[1][1]);

        console.log('Moving a ' + name + ' from '
                    + data.join(' to ') + ' returns ' + returnVal);
        console.log(board.getPiecemap());
}

function translate(cellString) {
        var map = {
                    'A': '1',
                    'B': '2',
                    'C': '3',
                    'D': '4',
                    'E': '5',
                    'F': '6',
                    'G': '7',
                    'H': '8'
                };

        cellString = cellString.replace(/^[A-H]/, function(char) { return map[char] });
        return cellString;
}

testPiece();