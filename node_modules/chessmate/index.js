var EventEmitter = require('events').EventEmitter;
var communicationServer = require('Comms');
var gameEngine = require('Engine');
var bus = require('systemBus');

function chessmate() {
    this.engine;
    this.comms = new communicationServer();
    this.bus = bus;
    bus.on('moved', function(data) {
        var move = { move: data.join('-') };
        bus.emit('sendMove', move);
    });
}

chessmate.prototype.receive = function(message) {
    return this.comms.receive(message);
};

chessmate.prototype.isCommand = function(message) {
    return this.comms.test(message);
};

chessmate.prototype.createGame = function() {
    if (this.engine === undefined)
        return this.engine = new gameEngine();
    else
        return false;
};

module.exports = chessmate;